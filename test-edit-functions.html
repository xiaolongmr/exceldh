<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¼–è¾‘åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 900px;
            margin: 0 auto;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background: #fafafa;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .test-steps {
            list-style: none;
            padding: 0;
        }
        .test-steps li {
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        .test-steps li:before {
            content: "ğŸ”¸ ";
            margin-right: 8px;
        }
        .console-log {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 10px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-running { background: #ffc107; }
        .status-success { background: #28a745; }
        .status-error { background: #dc3545; }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ› ï¸ ç¼–è¾‘åŠŸèƒ½æµ‹è¯•é¡µé¢</h1>
        
        <div class="test-section success">
            <h3>âœ… ä¿®å¤å†…å®¹æ€»ç»“</h3>
            <ul>
                <li><strong>æ‹–æ‹½æ’åºåŠŸèƒ½</strong> - å¢åŠ è¯¦ç»†æ—¥å¿—å’Œæ•°æ®é‡æ–°åŠ è½½</li>
                <li><strong>ç¼–è¾‘é“¾æ¥æ›´æ–°</strong> - å¢å¼ºé”™è¯¯å¤„ç†å’ŒçŠ¶æ€åé¦ˆ</li>
                <li><strong>åˆ é™¤æ”¶è—åŠŸèƒ½</strong> - ä¼˜åŒ–ç”¨æˆ·ä½“éªŒå’Œé”™è¯¯æç¤º</li>
                <li><strong>æ•°æ®åŒæ­¥</strong> - ç¡®ä¿æ“ä½œåç«‹å³åˆ·æ–°æ˜¾ç¤º</li>
            </ul>
        </div>

        <div class="test-section">
            <h3>ğŸ§ª æµ‹è¯•æ­¥éª¤</h3>
            <ol class="test-steps">
                <li>
                    <strong>ç™»å½•æµ‹è¯•</strong><br>
                    <small>ç¡®ä¿æ‚¨å·²ç™»å½•åˆ°ç³»ç»Ÿï¼ŒæŸ¥çœ‹æ”¶è—åŒºåŸŸæ˜¯å¦æ˜¾ç¤º</small>
                </li>
                <li>
                    <strong>æ‹–æ‹½æ’åºæµ‹è¯•</strong><br>
                    <small>è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œæ‹–æ‹½æ”¶è—å¡ç‰‡ï¼Œç‚¹å‡»ä¿å­˜ï¼Œæ£€æŸ¥æ’åºæ˜¯å¦ç”Ÿæ•ˆ</small>
                </li>
                <li>
                    <strong>ç¼–è¾‘é“¾æ¥æµ‹è¯•</strong><br>
                    <small>åœ¨ç¼–è¾‘æ¨¡å¼ä¸‹ç‚¹å‡»æ”¶è—å¡ç‰‡ï¼Œä¿®æ”¹ä¿¡æ¯åç‚¹å‡»æ›´æ–°</small>
                </li>
                <li>
                    <strong>åˆ é™¤åŠŸèƒ½æµ‹è¯•</strong><br>
                    <small>åœ¨ç¼–è¾‘æ¨¡å¼ä¸‹ç‚¹å‡»åˆ é™¤æŒ‰é’®(Ã—)ï¼Œç¡®è®¤åˆ é™¤æ“ä½œ</small>
                </li>
            </ol>
        </div>

        <div class="test-section">
            <h3>ğŸ“Š å®æ—¶çŠ¶æ€ç›‘æ§</h3>
            <div id="status-display">
                <div><span class="status-indicator status-running"></span>ç­‰å¾…æµ‹è¯•å¼€å§‹...</div>
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ¯ å¿«é€Ÿæµ‹è¯•</h3>
            <button class="test-button" onclick="testDragSort()">æµ‹è¯•æ‹–æ‹½æ’åº</button>
            <button class="test-button" onclick="testEditUpdate()">æµ‹è¯•ç¼–è¾‘æ›´æ–°</button>
            <button class="test-button" onclick="testDeleteFunction()">æµ‹è¯•åˆ é™¤åŠŸèƒ½</button>
            <button class="test-button" onclick="checkTokenStatus()">æ£€æŸ¥ç™»å½•çŠ¶æ€</button>
        </div>

        <div class="test-section">
            <h3>ğŸ“‹ æ§åˆ¶å°æ—¥å¿—</h3>
            <div id="console-output" class="console-log">
                <div>ç­‰å¾…æ—¥å¿—è¾“å‡º...</div>
            </div>
            <button class="test-button" onclick="clearConsole()">æ¸…ç©ºæ—¥å¿—</button>
            <button class="test-button" onclick="exportLogs()">å¯¼å‡ºæ—¥å¿—</button>
        </div>

        <div class="test-section warning">
            <h3>âš ï¸ æ³¨æ„äº‹é¡¹</h3>
            <ul>
                <li>ç¡®ä¿åœ¨ä¸»é¡µé¢(index.html)è¿›è¡Œå®é™…æµ‹è¯•</li>
                <li>æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹è¯¦ç»†æ—¥å¿—</li>
                <li>æµ‹è¯•å‰è¯·ç¡®ä¿å·²ç™»å½•è´¦æˆ·</li>
                <li>å¦‚æœåŠŸèƒ½ä»æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯</li>
            </ul>
        </div>
    </div>

    <script>
        console.log('ğŸ§ª ç¼–è¾‘åŠŸèƒ½æµ‹è¯•é¡µé¢å·²åŠ è½½');
        
        let logs = [];
        
        // æ•è·æ§åˆ¶å°æ—¥å¿—
        const originalLog = console.log;
        const originalError = console.error;
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            logToDisplay('LOG', args.join(' '));
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            logToDisplay('ERROR', args.join(' '));
        };
        
        function logToDisplay(type, message) {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${type}: ${message}`;
            logs.push(logEntry);
            
            const output = document.getElementById('console-output');
            if (output) {
                output.innerHTML += `<div style="color: ${type === 'ERROR' ? 'red' : 'black'}">${logEntry}</div>`;
                output.scrollTop = output.scrollHeight;
            }
        }
        
        // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
        function updateStatus(message, status = 'running') {
            const statusDisplay = document.getElementById('status-display');
            if (statusDisplay) {
                statusDisplay.innerHTML = `<div><span class="status-indicator status-${status}"></span>${message}</div>`;
            }
        }
        
        // æµ‹è¯•å‡½æ•°
        function testDragSort() {
            updateStatus('æ­£åœ¨æµ‹è¯•æ‹–æ‹½æ’åºåŠŸèƒ½...', 'running');
            console.log('ğŸ§ª å¼€å§‹æµ‹è¯•æ‹–æ‹½æ’åºåŠŸèƒ½');
            
            // æ£€æŸ¥æ˜¯å¦åœ¨ä¸»é¡µé¢
            if (typeof window.toggleCustomMode === 'function') {
                console.log('âœ… ç¼–è¾‘æ¨¡å¼å‡½æ•°å­˜åœ¨');
                updateStatus('æ‹–æ‹½æ’åºåŠŸèƒ½å¯ç”¨ï¼Œè¯·åœ¨ä¸»é¡µé¢è¿›è¡Œå®é™…æµ‹è¯•', 'success');
            } else {
                console.error('âŒ ç¼–è¾‘æ¨¡å¼å‡½æ•°ä¸å­˜åœ¨ï¼Œè¯·åœ¨ä¸»é¡µé¢æµ‹è¯•');
                updateStatus('è¯·åœ¨ä¸»é¡µé¢(index.html)è¿›è¡Œæµ‹è¯•', 'error');
            }
        }
        
        function testEditUpdate() {
            updateStatus('æ­£åœ¨æµ‹è¯•ç¼–è¾‘æ›´æ–°åŠŸèƒ½...', 'running');
            console.log('ğŸ§ª å¼€å§‹æµ‹è¯•ç¼–è¾‘æ›´æ–°åŠŸèƒ½');
            
            if (typeof updateFavorite === 'function') {
                console.log('âœ… æ›´æ–°å‡½æ•°å­˜åœ¨');
                updateStatus('ç¼–è¾‘æ›´æ–°åŠŸèƒ½å¯ç”¨ï¼Œè¯·åœ¨ä¸»é¡µé¢è¿›è¡Œå®é™…æµ‹è¯•', 'success');
            } else {
                console.error('âŒ æ›´æ–°å‡½æ•°ä¸å­˜åœ¨ï¼Œè¯·åœ¨ä¸»é¡µé¢æµ‹è¯•');
                updateStatus('è¯·åœ¨ä¸»é¡µé¢(index.html)è¿›è¡Œæµ‹è¯•', 'error');
            }
        }
        
        function testDeleteFunction() {
            updateStatus('æ­£åœ¨æµ‹è¯•åˆ é™¤åŠŸèƒ½...', 'running');
            console.log('ğŸ§ª å¼€å§‹æµ‹è¯•åˆ é™¤åŠŸèƒ½');
            
            if (typeof window.removeFav === 'function') {
                console.log('âœ… åˆ é™¤å‡½æ•°å­˜åœ¨');
                updateStatus('åˆ é™¤åŠŸèƒ½å¯ç”¨ï¼Œè¯·åœ¨ä¸»é¡µé¢è¿›è¡Œå®é™…æµ‹è¯•', 'success');
            } else {
                console.error('âŒ åˆ é™¤å‡½æ•°ä¸å­˜åœ¨ï¼Œè¯·åœ¨ä¸»é¡µé¢æµ‹è¯•');
                updateStatus('è¯·åœ¨ä¸»é¡µé¢(index.html)è¿›è¡Œæµ‹è¯•', 'error');
            }
        }
        
        function checkTokenStatus() {
            updateStatus('æ­£åœ¨æ£€æŸ¥ç™»å½•çŠ¶æ€...', 'running');
            console.log('ğŸ§ª æ£€æŸ¥ç™»å½•çŠ¶æ€');
            
            const token = localStorage.getItem('neon_auth_token');
            if (token) {
                console.log('âœ… æ‰¾åˆ°è®¤è¯ä»¤ç‰Œ');
                updateStatus('ç”¨æˆ·å·²ç™»å½•ï¼Œå¯ä»¥è¿›è¡ŒåŠŸèƒ½æµ‹è¯•', 'success');
            } else {
                console.error('âŒ æœªæ‰¾åˆ°è®¤è¯ä»¤ç‰Œ');
                updateStatus('ç”¨æˆ·æœªç™»å½•ï¼Œè¯·å…ˆç™»å½•åå†æµ‹è¯•', 'error');
            }
        }
        
        function clearConsole() {
            const output = document.getElementById('console-output');
            if (output) {
                output.innerHTML = '<div>æ—¥å¿—å·²æ¸…ç©º...</div>';
                logs = [];
            }
        }
        
        function exportLogs() {
            const logContent = logs.join('\n');
            const blob = new Blob([logContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `edit-function-test-logs-${new Date().toISOString().slice(0,10)}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥çŠ¶æ€
        window.addEventListener('load', () => {
            console.log('ğŸš€ ç¼–è¾‘åŠŸèƒ½æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
            updateStatus('æµ‹è¯•é¡µé¢å‡†å¤‡å°±ç»ªï¼Œè¯·ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•', 'success');
            
            // è‡ªåŠ¨æ£€æŸ¥ç™»å½•çŠ¶æ€
            setTimeout(checkTokenStatus, 1000);
        });
    </script>
</body>
</html>